<!--pages/admin/coach-manage/coach-manage.wxml-->
<view class="coach-manage-container">
  <!-- é¡¶éƒ¨æ“ä½œæ  -->
  <view class="header-bar">
    <input class="search-input" placeholder="æœç´¢æ•™ç»ƒå§“å" value="{{keyword}}" bindinput="onSearchInput" />
    <button class="search-btn" bindtap="onSearch">æœç´¢</button>
    <button class="add-btn" bindtap="goToAddCoach">
      <!-- <text class="add-icon">+</text> -->
      <text>æ·»åŠ æ•™ç»ƒ</text>
    </button>
  </view>

  <!-- æ•™ç»ƒåˆ—è¡¨ -->
  <view class="coach-list" wx:if="{{!loading && coachList.length > 0}}">
    <view class="coach-item" wx:for="{{coachList}}" wx:key="_id">
      <view class="coach-info" bindtap="goToEditCoach" data-id="{{item._id}}">
        <!-- å¤´åƒ -->
        <image wx:if="{{item.avatarUrl}}"
               class="coach-avatar"
               src="{{item.cloudAvatarUrl || item.avatarUrl}}"
               mode="aspectFill"
               binderror="onImageError"
               data-index="{{index}}"
               data-cloudurl="{{item.cloudAvatarUrl}}">
        </image>
        <view wx:else class="coach-avatar default-avatar">ğŸ‘¨â€ğŸ«</view>
        <view class="coach-detail">
          <view class="coach-name-row">
            <!-- æ˜¾ç¤ºçŠ¶æ€ -->
            <block wx:if="{{editingCoachId !== item._id}}">
              <text class="coach-name">{{item.name || item.nickname || 'æœªè®¾ç½®å§“å'}}</text>
              <text class="edit-name-btn" catchtap="startEditName" data-id="{{item._id}}" data-name="{{item.name || item.nickname}}">âœï¸</text>
            </block>
            <!-- ç¼–è¾‘çŠ¶æ€ -->
            <block wx:else>
              <input class="name-input" value="{{editingName}}" bindinput="onNameInput" catchtap="" placeholder="è¾“å…¥æ˜µç§°" />
              <text class="save-name-btn" catchtap="saveName" data-id="{{item._id}}">âœ“</text>
              <text class="cancel-name-btn" catchtap="cancelEdit">âœ—</text>
            </block>
            <view class="status-badge status-{{item.status}}">
              <text>{{item.status === 1 ? 'å¯ç”¨' : 'ç¦ç”¨'}}</text>
            </view>
          </view>
          <text class="coach-specialty" wx:if="{{item.specialty && item.specialty.length > 0}}">
            ä¸“é•¿ï¼š{{item.specialty[0]}}{{item.specialty.length > 1 ? ' ç­‰' + item.specialty.length + 'é¡¹' : ''}}
          </text>
          <text class="coach-intro" wx:if="{{item.introduction && item.introduction !== 'æš‚æ— ç®€ä»‹'}}">
            {{item.introduction}}
          </text>
          <view class="coach-meta">
            <text class="meta-item">â­ {{item.rating || '5.0'}}</text>
            <text class="meta-item">ğŸ“ {{item.reviewCount || 0}}æ¡è¯„ä»·</text>
          </view>
        </view>
      </view>
      <view class="coach-actions">
        <!-- æ’åºæŒ‰é’® -->
        <button class="action-btn move-btn" catchtap="moveUp" data-index="{{index}}" wx:if="{{index > 0}}">â†‘ ä¸Šç§»</button>
        <button class="action-btn move-btn" catchtap="moveDown" data-index="{{index}}" wx:if="{{index < coachList.length - 1}}">â†“ ä¸‹ç§»</button>
        <!-- æ“ä½œæŒ‰é’® -->
        <button class="action-btn edit" catchtap="goToEditCoach" data-id="{{item._id}}">ç¼–è¾‘</button>
        <button class="action-btn toggle" catchtap="toggleStatus" data-id="{{item._id}}" data-status="{{item.status}}">
          {{item.status === 1 ? 'ç¦ç”¨' : 'å¯ç”¨'}}
        </button>
        <button class="action-btn delete" catchtap="deleteCoach" data-id="{{item._id}}" data-name="{{item.name}}">åˆ é™¤</button>
      </view>
    </view>
  </view>

  <!-- åŠ è½½ä¸­ -->
  <view class="loading-container" wx:if="{{loading}}">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-container" wx:if="{{!loading && coachList.length === 0}}">
    <text class="empty-icon">ğŸ‘¨â€ğŸ«</text>
    <text class="empty-text">æš‚æ— æ•™ç»ƒ</text>
    <text class="empty-hint">ç‚¹å‡»ä¸Šæ–¹"æ·»åŠ æ•™ç»ƒ"å¼€å§‹æ·»åŠ </text>
  </view>
</view>
