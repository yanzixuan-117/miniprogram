<!--pages/admin/coach-manage/coach-select.wxml-->
<view class="user-select-container">
  <!-- é¡¶éƒ¨æœç´¢æ  -->
  <view class="header-bar">
    <view class="search-bar">
      <input class="search-input" placeholder="æœç´¢ç”¨æˆ·æ˜µç§°" value="{{keyword}}" bindinput="onSearchInput" />
      <button class="search-btn" bindtap="onSearch">æœç´¢</button>
    </view>
    <view class="filter-bar">
      <picker mode="selector" range="{{['å…¨éƒ¨ç”¨æˆ·', 'å­¦å‘˜', 'æ•™ç»ƒ']}}" range-key="" value="{{roleFilter === 'all' ? 0 : roleFilter === 'student' ? 1 : 2}}" bindchange="onRoleFilterChange">
        <view class="filter-picker">
          <text>ç­›é€‰ï¼š{{roleFilter === 'all' ? 'å…¨éƒ¨ç”¨æˆ·' : roleFilter === 'student' ? 'å­¦å‘˜' : 'æ•™ç»ƒ'}}</text>
          <text class="arrow">â–¼</text>
        </view>
      </picker>
    </view>
  </view>

  <!-- è°ƒè¯•ä¿¡æ¯ -->
  <view style="background: #ffeb3b; padding: 10rpx; font-size: 24rpx; margin: 0;">
    <text>è°ƒè¯•: å…±{{userList.length}}ä¸ªç”¨æˆ·</text>
  </view>

  <!-- ç”¨æˆ·åˆ—è¡¨ -->
  <view class="user-list" wx:if="{{!loading && userList.length > 0}}">
    <view class="user-item" wx:for="{{userList}}" wx:key="_openid" bindtap="selectUser" data-openid="{{item._openid}}" data-name="{{item.nickname}}" data-role="{{item.role}}">
      <!-- å¤´åƒ -->
      <image wx:if="{{item.avatarUrl}}"
             class="user-avatar"
             src="{{item.avatarUrl}}"
             mode="aspectFill"
             binderror="onUserImageError"
             data-url="{{item.avatarUrl}}"
             data-name="{{item.nickname}}"
             data-index="{{index}}">
      </image>
      <view wx:else class="user-avatar default-avatar">ğŸ‘¤</view>
      <view class="user-detail">
        <view class="user-name-row">
          <text class="user-name">{{item.nickname || 'æœªè®¾ç½®æ˜µç§°'}}</text>
          <view class="role-badge {{item.role}}">
            <text>{{item.role === 'student' ? 'å­¦å‘˜' : item.role === 'coach' ? 'æ•™ç»ƒ' : 'ç®¡ç†å‘˜'}}</text>
          </view>
        </view>
        <text class="user-phone" wx:if="{{item.phone}}">{{item.phone}}</text>
        <text class="user-time">æ³¨å†Œæ—¶é—´ï¼š{{item.createTime ? item.createTime.slice(5, 16) : 'æœªçŸ¥'}}</text>
      </view>
      <view class="select-icon">
        <text wx:if="{{item.role === 'coach'}}">âœ“</text>
        <text wx:else class="add-text">æ·»åŠ </text>
      </view>
    </view>
  </view>

  <!-- åŠ è½½ä¸­ -->
  <view class="loading-container" wx:if="{{loading}}">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-container" wx:if="{{!loading && userList.length === 0}}">
    <text class="empty-icon">ğŸ‘¥</text>
    <text class="empty-text">æš‚æ— ç”¨æˆ·</text>
  </view>
</view>
