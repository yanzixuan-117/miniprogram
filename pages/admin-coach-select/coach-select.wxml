<!--pages/admin-coach-select/coach-select.wxml-->
<view class="select-container">
  <!-- é¡¶éƒ¨ç­›é€‰æ  -->
  <view class="filter-bar">
    <picker class="role-picker" mode="selector" range="{{['å…¨éƒ¨', 'å­¦å‘˜', 'æ•™ç»ƒ']}}" range-key="" value="{{roleFilter === 'all' ? 0 : (roleFilter === 'student' ? 1 : 2)}}" bindchange="onRoleFilterChange">
      <view class="picker-display">
        <text class="picker-text">{{roleFilter === 'all' ? 'å…¨éƒ¨ç”¨æˆ·' : (roleFilter === 'student' ? 'ä»…æ˜¾ç¤ºå­¦å‘˜' : 'ä»…æ˜¾ç¤ºæ•™ç»ƒ')}}</text>
        <text class="picker-arrow">â–¼</text>
      </view>
    </picker>

    <input class="search-input" placeholder="æœç´¢ç”¨æˆ·æ˜µç§°" value="{{keyword}}" bindinput="onSearchInput" />
    <button class="search-btn" bindtap="onSearch">æœç´¢</button>
  </view>

  <!-- ç”¨æˆ·åˆ—è¡¨ -->
  <view class="user-list" wx:if="{{!loading && userList.length > 0}}">
    <view class="user-item" wx:for="{{userList}}" wx:key="_openid" bindtap="selectUser" data-openid="{{item._openid}}" data-name="{{item.nickname}}" data-role="{{item.role}}">
      <image
        class="user-avatar"
        src="{{item.avatarUrl }}"
        mode="aspectFill"
        binderror="onUserImageError"
        data-url="{{item.avatarUrl}}"
        data-name="{{item.nickname}}"
        data-index="{{index}}">
      </image>
      <view class="user-info">
        <text class="user-name">{{item.nickname || 'æœªè®¾ç½®æ˜µç§°'}}</text>
        <view class="user-meta">
          <text class="meta-item role-{{item.role}}">{{item.role === 'coach' ? 'æ•™ç»ƒ' : 'å­¦å‘˜'}}</text>
          <text class="meta-item" wx:if="{{item.createTimeText}}">{{item.createTimeText}}</text>
        </view>
      </view>
      <view class="user-action">
        <text class="action-text">{{item.role === 'coach' ? 'å·²æ˜¯æ•™ç»ƒ' : 'æ·»åŠ ä¸ºæ•™ç»ƒ'}}</text>
      </view>
    </view>
  </view>

  <!-- åŠ è½½ä¸­ -->
  <view class="loading-container" wx:if="{{loading}}">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-container" wx:if="{{!loading && userList.length === 0}}">
    <text class="empty-icon">ğŸ‘¥</text>
    <text class="empty-text">æš‚æ— ç”¨æˆ·</text>
  </view>
</view>
